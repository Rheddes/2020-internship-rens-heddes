USE vulnerability-history;
SET @@time_zone = '+00:00';

CREATE TABLE vulnerabilities (
    cve VARCHAR(255) NOT NULL,
    package_coords VARCHAR(255) NOT NULL,
    libraries_io_find_prefix VARCHAR(255) NOT NULL,
    first_fix_release_date DATE NOT NULL,
    samples INTEGER DEFAULT 100,
    status VARCHAR(255) DEFAULT 'new'
);

CREATE TABLE repos (
    id INTEGER AUTO_INCREMENT,
    cve VARCHAR(255) NOT NULL,
    full_name VARCHAR(255) NOT NULL,
    pom_path VARCHAR(255) NOT NULL,
    status VARCHAR(255) DEFAULT 'new',
    PRIMARY KEY (id)
);

CREATE TABLE updates (
    id INTEGER AUTO_INCREMENT,
    repo_id INTEGER,
    cve VARCHAR(255) NOT NULL,
    package VARCHAR(255) NOT NULL,
    update_delay INTEGER NOT NULL,
    commit_hash  VARCHAR(255) NOT NULL,
    is_fix_update TINYINT(1),
    old_version VARCHAR(255) NOT NULL,
    old_release_date DATE NOT NULL,
    new_version VARCHAR(255) NOT NULL,
    new_release_date DATE NOT NULL,
    PRIMARY KEY (id)
);

INSERT INTO vulnerabilities (cve, package_coords, libraries_io_find_prefix, first_fix_release_date, samples)
VALUES ('CVE-2020-8908', 'com.google.guava:guava', '30', '2020-08-27', 10);
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (1, 'CVE-2020-8908', 'google/truth', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (2, 'CVE-2020-8908', 'flapdoodle-oss/de.flapdoodle.embed.mongo', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (3, 'CVE-2020-8908', 'google/compile-testing', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (4, 'CVE-2020-8908', 'jqno/equalsverifier', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (5, 'CVE-2020-8908', 'apache/maven-resolver', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (6, 'CVE-2020-8908', 'google/jimfs', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (7, 'CVE-2020-8908', 'bonigarcia/webdrivermanager', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (8, 'CVE-2020-8908', 'code4craft/webmagic', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (9, 'CVE-2020-8908', 'google/google-java-format', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (10, 'CVE-2020-8908', 'snazy/ohc', 'pom.xml', 'new');
INSERT INTO `vulnerability-history`.repos (id, cve, full_name, pom_path, status) VALUES (11, 'CVE-2020-8908', 'asterisk-java/asterisk-java', 'pom.xml', 'new');
